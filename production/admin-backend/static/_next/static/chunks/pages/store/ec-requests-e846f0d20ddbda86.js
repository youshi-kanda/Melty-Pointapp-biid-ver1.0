(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5122],{9741:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/store/ec-requests",function(){return s(9650)}])},5925:function(e,t,s){"use strict";s.d(t,{Kb:function(){return l},kG:function(){return r}});let a={BASE_URL:"https://api.biid-point.com",ENDPOINTS:{LOGIN:"/api/auth/login/",REFRESH:"/api/auth/refresh/",LOGOUT:"/api/auth/logout/",PAYMENTS:"/api/core/payments/",PAYMENT_STATUS:"/api/core/payments/status/",MOCK_PAYMENT:"/api/core/payments/mock/",GMOPG_INITIATE:"/api/gmopg/payment/initiate/",GMOPG_STATUS:"/api/gmopg/payment/status/",POINTS_GRANT:"/api/core/points/grant/",POINTS_HISTORY:"/api/core/points/history/",USER_ME:"/api/core/user/me/",HEALTH:"/api/health/",STATUS:"/api/status/"},TIMEOUT:3e4,HEADERS:{"Content-Type":"application/json",Accept:"application/json"}};function r(){{let e=window.location.hostname;if("biid-user.fly.dev"===e||e.includes("biid-user"))return"https://biid-user-api.fly.dev";if("localhost"===e||"127.0.0.1"===e)return"http://localhost:8000"}return"https://biid-user-api.fly.dev"}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="".concat(a.BASE_URL).concat(e);try{let e=await fetch(s,{...t,headers:{...a.HEADERS,...t.headers},signal:AbortSignal.timeout(a.TIMEOUT)}),r=e.headers.get("content-type");if(!(null==r?void 0:r.includes("application/json"))){let t=await e.text();if(console.warn("Non-JSON response from API:",{url:s,status:e.status,contentType:r,preview:t.substring(0,200)}),t.includes("<!DOCTYPE")||t.includes("<html"))throw Error("Server returned HTML error page (".concat(e.status,")"))}if(!e.ok)throw Error("API Error: ".concat(e.status," ").concat(e.statusText));return await e.json()}catch(e){throw e instanceof SyntaxError&&e.message.includes("Unexpected token")&&console.error("JSON Parse Error - received invalid response:",{url:s,error:e.message,suggestion:"Check if server is returning HTML instead of JSON"}),console.error("API Call failed:",e),e}}let l={initiate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"qr";return n(a.ENDPOINTS.PAYMENTS,{method:"POST",body:JSON.stringify({amount:e,payment_method:t})})},checkStatus:e=>n("".concat(a.ENDPOINTS.PAYMENT_STATUS,"?transaction_id=").concat(e)),mock:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"success",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return n(a.ENDPOINTS.MOCK_PAYMENT,{method:"POST",body:JSON.stringify({action:e,amount:t})})}}},3633:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},8865:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},3050:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},7695:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},39:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},4235:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},5928:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},2553:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},1998:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},9073:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]])},8760:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},8979:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},2606:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]])},775:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])},6722:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("megaphone",[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]])},8497:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]])},7656:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]])},3750:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]])},6127:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},3603:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},5264:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},116:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("store",[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]])},2542:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},8267:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2190:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9650:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return D}});var a=s(5893),r=s(7294),n=s(9008),l=s.n(n),i=s(5675),c=s.n(i),o=s(1163),d=s(1664),h=s.n(d),u=s(8979),x=s(116),p=s(4235),m=s(3750),f=s(2553),g=s(3633),b=s(6722),y=s(5264),j=s(2190),N=s(8497),v=s(9073),w=s(8267),k=s(775);function Z(e){let{currentPage:t}=e,s=(0,o.useRouter)(),[n,l]=(0,r.useState)(!1),i=[{icon:u.Z,label:"ダッシュボード",sublabel:"売上・顧客情報",href:"/store",id:"dashboard"},{icon:x.Z,label:"店舗情報",sublabel:"プロフィール・基本情報",href:"/store/profile",id:"profile"},{icon:p.Z,label:"チャージ",sublabel:"アカウントチャージ",href:"/store/charge",id:"charge"},{icon:m.Z,label:"レシート",sublabel:"取引履歴・レシート",href:"/store/receipt",id:"receipt"},{icon:f.Z,label:"EC購入申請",sublabel:"ポイント付与申請",href:"/store/ec-requests",id:"ec-requests"},{icon:g.Z,label:"月次レポート",sublabel:"売上・統計レポート",href:"/store/reports",id:"reports"},{icon:b.Z,label:"プロモーション",sublabel:"キャンペーン管理",href:"/store/promotions",id:"promotions"},{icon:y.Z,label:"設定",sublabel:"システム設定",href:"/store/settings",id:"settings"}];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>l(!n),className:"lg:hidden fixed top-4 left-4 z-50 p-2 bg-white rounded-lg shadow-lg",children:n?(0,a.jsx)(j.Z,{size:24}):(0,a.jsx)(N.Z,{size:24})}),n&&(0,a.jsx)("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-40",onClick:()=>l(!1)}),(0,a.jsxs)("aside",{className:"\n          fixed top-0 left-0 h-full w-64 bg-gradient-to-b from-purple-600 via-pink-600 to-purple-700 text-white shadow-2xl z-40 transform transition-transform duration-300\n          ".concat(n?"translate-x-0":"-translate-x-full","\n          lg:translate-x-0\n        "),children:[(0,a.jsx)("div",{className:"p-6 border-b border-white/10",children:(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:(0,a.jsx)(v.Z,{size:24,className:"text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:"Biid Point"}),(0,a.jsx)("p",{className:"text-xs text-purple-200",children:"Management"})]})]})}),(0,a.jsx)("nav",{className:"p-4 space-y-1 overflow-y-auto h-[calc(100vh-280px)]",children:i.map(e=>{let r=e.icon,n=t===e.id||s.pathname===e.href;return(0,a.jsx)(h(),{href:e.href,className:"\n                  block px-4 py-3 rounded-lg transition-all group\n                  ".concat(n?"bg-white/20 backdrop-blur-sm shadow-lg border border-white/20":"hover:bg-white/10","\n                "),onClick:()=>l(!1),children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(r,{size:20,className:n?"text-white":"text-white/80 group-hover:text-white"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-sm ".concat(n?"text-white":"text-white/90 group-hover:text-white"),children:e.label}),(0,a.jsx)("div",{className:"text-xs text-white/60 mt-0.5",children:e.sublabel})]})]})},e.id)})}),(0,a.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 border-t border-white/10 bg-black/10",children:[(0,a.jsx)("div",{className:"p-4 border-b border-white/10",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:(0,a.jsx)(w.Z,{size:20,className:"text-white"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-white truncate",children:"店長"}),(0,a.jsx)("div",{className:"text-xs text-purple-200 truncate",children:"store@example.com"})]})]})}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("button",{onClick:()=>{console.log("ログアウト"),s.push("/store/login")},className:"flex items-center gap-3 px-4 py-2 w-full rounded-lg text-white hover:bg-white/10 transition-all",children:[(0,a.jsx)(k.Z,{size:18}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"ログアウト"})]})}),(0,a.jsxs)("div",{className:"px-4 pb-4",children:[(0,a.jsx)("div",{className:"text-xs text-purple-200 mb-2",children:"今日の状況"}),(0,a.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-white/80",children:[(0,a.jsx)("span",{children:"売上"}),(0,a.jsx)("span",{className:"font-semibold text-white",children:"\xa545,000"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-white/80",children:[(0,a.jsx)("span",{children:"取引数"}),(0,a.jsx)("span",{className:"font-semibold text-white",children:"23"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-white/80",children:[(0,a.jsx)("span",{children:"ポイント発行"}),(0,a.jsx)("span",{className:"font-semibold text-emerald-300",children:"2,340pt"})]})]})]})]})]})]})}var M=s(39),S=s(3050),_=s(7695),T=s(1998),E=s(6127),A=s(2606),C=s(5928),O=s(8865),z=s(8760),P=s(7656),q=s(3603),I=s(2542),H=s(5925);function D(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)(null),[i,o]=(0,r.useState)(!1),[d,h]=(0,r.useState)(!1),[u,x]=(0,r.useState)("pending"),[p,m]=(0,r.useState)(""),[g,b]=(0,r.useState)(""),[y,N]=(0,r.useState)(""),[v,w]=(0,r.useState)(!1),k=async()=>{try{o(!0);let e=localStorage.getItem("auth_token"),s="all"===u?"".concat((0,H.kG)(),"/api/ec/store/all-requests/"):"".concat((0,H.kG)(),"/api/ec/store/pending-requests/"),a=await fetch(s,{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){let e=(await a.json()).requests||[];"all"!==u&&"pending"!==u&&(e=e.filter(e=>e.status===u)),t(e)}}catch(e){console.error("申請一覧の取得に失敗:",e)}finally{o(!1)}};(0,r.useEffect)(()=>{k()},[u]);let D=async e=>{if(confirm("この申請を承認しますか？\nクレジット決済でポイントが付与されます。"))try{h(!0);let t=localStorage.getItem("auth_token"),s=await fetch("".concat((0,H.kG)(),"/api/ec/store/requests/").concat(e,"/approve/"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({payment_method:"card_payment"})}),a=await s.json();s.ok&&a.success?(alert("承認しました。ポイントが付与されました。"),n(null),k()):alert(a.error||"承認に失敗しました")}catch(e){console.error("承認エラー:",e),alert("承認処理中にエラーが発生しました")}finally{h(!1)}},L=async()=>{if(!y.trim()){alert("拒否理由を入力してください");return}if(s)try{h(!0);let e=localStorage.getItem("auth_token"),t=await fetch("".concat((0,H.kG)(),"/api/ec/store/requests/").concat(s.id,"/approve/"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({action:"reject",rejection_reason:y})}),a=await t.json();t.ok&&a.success?(alert("申請を拒否しました"),w(!1),N(""),n(null),k()):alert(a.error||"拒否処理に失敗しました")}catch(e){console.error("拒否エラー:",e),alert("拒否処理中にエラーが発生しました")}finally{h(!1)}},G=async e=>{if(g.trim())try{let t=localStorage.getItem("auth_token");if((await fetch("".concat((0,H.kG)(),"/api/ec/requests/").concat(e,"/messages/"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({message:g})})).ok){b("");let s=await fetch("".concat((0,H.kG)(),"/api/ec/store/requests/").concat(e,"/"),{headers:{Authorization:"Bearer ".concat(t)}}).then(e=>e.json());n(s.request)}}catch(e){console.error("メッセージ送信エラー:",e)}},U=e=>{let t={pending:{bg:"bg-yellow-100",text:"text-yellow-700",icon:M.Z,label:"承認待ち"},approved:{bg:"bg-blue-100",text:"text-blue-700",icon:S.Z,label:"承認済み"},rejected:{bg:"bg-red-100",text:"text-red-700",icon:_.Z,label:"拒否"},completed:{bg:"bg-green-100",text:"text-green-700",icon:S.Z,label:"完了"}}[e],s=t.icon;return(0,a.jsxs)("span",{className:"".concat(t.bg," ").concat(t.text," px-3 py-1 rounded-full text-xs font-bold inline-flex items-center space-x-1"),children:[(0,a.jsx)(s,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:t.label})]})},J=e.filter(e=>""===p||e.user_name.toLowerCase().includes(p.toLowerCase())||e.order_id.toLowerCase().includes(p.toLowerCase()));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l(),{children:(0,a.jsx)("title",{children:"EC購入申請管理 - Melty+"})}),(0,a.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,a.jsx)(Z,{currentPage:"ec-requests"}),(0,a.jsx)("div",{className:"flex-1 overflow-auto",children:(0,a.jsxs)("div",{className:"p-8",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"EC購入申請管理"}),(0,a.jsx)("p",{className:"text-gray-600",children:"ユーザーからのポイント付与申請を管理"})]}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:[(0,a.jsx)(T.Z,{className:"w-4 h-4 inline mr-1"}),"ステータス"]}),(0,a.jsxs)("select",{value:u,onChange:e=>x(e.target.value),className:"w-full px-4 py-2 rounded-lg border-2 border-gray-200 focus:border-blue-400 focus:outline-none",children:[(0,a.jsx)("option",{value:"pending",children:"承認待ち"}),(0,a.jsx)("option",{value:"all",children:"すべて"}),(0,a.jsx)("option",{value:"approved",children:"承認済み"}),(0,a.jsx)("option",{value:"rejected",children:"拒否"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4 inline mr-1"}),"検索"]}),(0,a.jsx)("input",{type:"text",value:p,onChange:e=>m(e.target.value),placeholder:"ユーザー名、注文ID...",className:"w-full px-4 py-2 rounded-lg border-2 border-gray-200 focus:border-blue-400 focus:outline-none"})]})]})}),i?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(A.Z,{className:"w-12 h-12 animate-spin text-blue-500 mx-auto"}),(0,a.jsx)("p",{className:"text-gray-600 mt-4",children:"読み込み中..."})]}):0===J.length?(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[(0,a.jsx)(f.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"申請がありません"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4",children:J.map(e=>(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-lg hover:shadow-xl transition-shadow",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-400 to-blue-600 rounded-full flex items-center justify-center text-white font-bold",children:e.user_name.charAt(0)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:e.user_name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["注文ID: ",e.order_id]})]}),U(e.status)]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600 mb-1",children:"購入金額"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-gray-800",children:["\xa5",Number(e.purchase_amount).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600 mb-1",children:"付与ポイント"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-blue-600",children:[e.points_to_award," pt"]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600 mb-1",children:"申請日"}),(0,a.jsx)("p",{className:"text-sm font-bold text-gray-800",children:new Date(e.created_at).toLocaleDateString("ja-JP")})]})]})]}),(0,a.jsxs)("div",{className:"ml-4 flex flex-col space-y-2",children:[(0,a.jsxs)("button",{onClick:()=>n((null==s?void 0:s.id)===e.id?null:e),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-bold transition-colors flex items-center space-x-2",children:[(0,a.jsx)(C.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:(null==s?void 0:s.id)===e.id?"閉じる":"詳細"})]}),"pending"===e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>D(e.id),disabled:d,className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg text-sm font-bold transition-colors flex items-center space-x-2 disabled:opacity-50",children:[(0,a.jsx)(O.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"承認"})]}),(0,a.jsxs)("button",{onClick:()=>{n(e),w(!0)},disabled:d,className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm font-bold transition-colors flex items-center space-x-2 disabled:opacity-50",children:[(0,a.jsx)(j.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"拒否"})]})]})]})]}),(null==s?void 0:s.id)===e.id&&(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-bold text-gray-700 mb-3 flex items-center space-x-2",children:[(0,a.jsx)(z.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"レシート画像"})]}),e.receipt_image?(0,a.jsx)("div",{className:"border-2 border-gray-200 rounded-lg p-2 relative w-full",style:{height:"384px"},children:(0,a.jsx)(c(),{src:e.receipt_image,alt:"レシート",fill:!0,className:"object-contain rounded",unoptimized:!0})}):(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"画像なし"}),e.receipt_description&&(0,a.jsxs)("div",{className:"mt-3 bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm font-bold text-gray-700 mb-1",children:"備考"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.receipt_description})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-bold text-gray-700 mb-3 flex items-center space-x-2",children:[(0,a.jsx)(P.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"メッセージ"})]}),(0,a.jsxs)("div",{className:"border-2 border-gray-200 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"space-y-3 mb-4 max-h-64 overflow-y-auto",children:e.messages&&e.messages.length>0?e.messages.map(t=>(0,a.jsxs)("div",{className:"p-3 rounded-lg ".concat(t.is_from_store?"bg-blue-100 ml-8":"bg-gray-100 mr-8"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-xs font-bold text-gray-700",children:t.is_from_store?"\uD83C\uDFEA 店舗（あなた）":"\uD83D\uDC64 "+e.user_name}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:new Date(t.created_at).toLocaleString("ja-JP")})]}),(0,a.jsx)("p",{className:"text-sm text-gray-800",children:t.message})]},t.id)):(0,a.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"メッセージはありません"})}),"pending"===e.status&&(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("input",{type:"text",value:g,onChange:e=>b(e.target.value),placeholder:"メッセージを入力...",className:"flex-1 px-3 py-2 rounded-lg border-2 border-gray-200 focus:border-blue-400 focus:outline-none text-sm",onKeyPress:t=>{"Enter"===t.key&&G(e.id)}}),(0,a.jsx)("button",{onClick:()=>G(e.id),disabled:!g.trim(),className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-bold transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:(0,a.jsx)(q.Z,{className:"w-5 h-5"})})]})]})]})]})})]})},e.id))})]})})]}),v&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(I.Z,{className:"w-6 h-6 text-red-600"})}),(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"申請を拒否"})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"拒否理由を入力してください"}),(0,a.jsx)("textarea",{value:y,onChange:e=>N(e.target.value),className:"w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-red-400 focus:outline-none mb-4",rows:4,placeholder:"例: レシート画像が不鮮明です 例: 購入日時が異なります"}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:()=>{w(!1),N("")},className:"flex-1 px-4 py-3 bg-gray-100 hover:bg-gray-200 rounded-lg font-bold transition-colors",children:"キャンセル"}),(0,a.jsx)("button",{onClick:L,disabled:d||!y.trim(),className:"flex-1 px-4 py-3 bg-red-500 hover:bg-red-600 text-white rounded-lg font-bold transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?"処理中...":"拒否する"})]})]})})]})}},1163:function(e,t,s){e.exports=s(3079)}},function(e){e.O(0,[1664,554,2888,9774,179],function(){return e(e.s=9741)}),_N_E=e.O()}]);