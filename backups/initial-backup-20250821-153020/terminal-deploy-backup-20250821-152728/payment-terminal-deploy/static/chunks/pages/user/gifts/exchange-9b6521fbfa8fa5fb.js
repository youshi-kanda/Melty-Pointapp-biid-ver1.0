(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4124],{4297:function(e,s,t){"use strict";t.d(s,{Z:function(){return i}});var a=t(7294),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),i=(e,s)=>{let t=(0,a.forwardRef)(({color:t="currentColor",size:i=24,strokeWidth:l=2,absoluteStrokeWidth:c,className:d="",children:o,...x},m)=>(0,a.createElement)("svg",{ref:m,...r,width:i,height:i,stroke:t,strokeWidth:c?24*Number(l)/Number(i):l,className:["lucide",`lucide-${n(e)}`,d].join(" "),...x},[...s.map(([e,s])=>(0,a.createElement)(e,s)),...Array.isArray(o)?o:[o]]));return t.displayName=`${e}`,t}},7653:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3756:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3742:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},1831:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("Cherry",[["path",{d:"M2 17a5 5 0 0 0 10 0c0-2.76-2.5-5-5-3-2.5-2-5 .24-5 3Z",key:"cvxqlc"}],["path",{d:"M12 17a5 5 0 0 0 10 0c0-2.76-2.5-5-5-3-2.5-2-5 .24-5 3Z",key:"1ostrc"}],["path",{d:"M7 14c3.22-2.91 4.29-8.75 5-12 1.66 2.38 4.94 9 5 12",key:"hqx58h"}],["path",{d:"M22 9c-4.29 0-7.14-2.33-10-7 5.71 0 10 4.67 10 7Z",key:"eykp1o"}]])},5077:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},1981:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},7669:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]])},7420:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},1197:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},8463:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},7764:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},2841:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},9525:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},9461:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(4297).Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]])},334:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/gifts/exchange",function(){return t(5921)}])},5921:function(e,s,t){"use strict";t.r(s);var a=t(5893),r=t(7294),n=t(1163),i=t(9461),l=t(8463),c=t(7669),d=t(1197),o=t(1831),x=t(7420),m=t(3756),p=t(7653),u=t(2841),h=t(7764),g=t(1981),f=t(9525),y=t(3742),j=t(5077);s.default=()=>{let e=(0,n.useRouter)(),[s,t]=(0,r.useState)("gifts"),[b,v]=(0,r.useState)([]),[N,_]=(0,r.useState)([]),[w,k]=(0,r.useState)([]),[Z,C]=(0,r.useState)(null),[S,$]=(0,r.useState)(""),[q,M]=(0,r.useState)(null),[L,A]=(0,r.useState)({recipient_email:"",recipient_name:"",delivery_address:"",notes:""}),[z,E]=(0,r.useState)(!0),[F,T]=(0,r.useState)(!1),[D,H]=(0,r.useState)(null),[O,P]=(0,r.useState)(null),[U,I]=(0,r.useState)(0),[X,B]=(0,r.useState)([]),[G,R]=(0,r.useState)([]),[V,W]=(0,r.useState)(""),[J,K]=(0,r.useState)({recipient_id:null,points:0,message:""}),[Q,Y]=(0,r.useState)(!1),[ee,es]=(0,r.useState)(null),[et,ea]=(0,r.useState)({present_reward_enabled:!0,present_reward_rate:5,min_present_amount:100,max_present_amount:1e4,daily_present_limit:5e4});(0,r.useEffect)(()=>{er()},[]),(0,r.useEffect)(()=>{ec()},[N,Z,S]),(0,r.useEffect)(()=>{ei()},[X,V]);let er=async()=>{try{await en(),v([{id:1,name:"デジタルギフト",description:"デジタル商品",icon:"digital",is_active:!0},{id:2,name:"商品券・クーポン",description:"各種商品券",icon:"coupon",is_active:!0},{id:3,name:"現物商品",description:"実物商品",icon:"physical",is_active:!0}]),_([{id:1,name:"Amazonギフト券 500円分",description:"Amazon.co.jpで使用できるギフト券です",category:1,category_name:"デジタルギフト",gift_type:"digital",points_required:500,original_price:"500",stock_quantity:100,unlimited_stock:!0,image_url:"https://picsum.photos/300/200?random=1",provider_name:"Amazon",usage_instructions:"メールで送信されるコードをAmazonで入力してください",terms_conditions:"有効期限は発行から1年間です",exchange_count:245,is_available:!0,created_at:"2024-01-01"},{id:2,name:"スターバックス ドリンクチケット",description:"スターバックスで使えるドリンクチケット",category:2,category_name:"商品券・クーポン",gift_type:"voucher",points_required:600,original_price:"600",stock_quantity:50,unlimited_stock:!1,image_url:"https://picsum.photos/300/200?random=2",provider_name:"スターバックス",usage_instructions:"店舗でバーコードを提示してください",terms_conditions:"有効期限は6ヶ月間です",exchange_count:156,is_available:!0,created_at:"2024-01-01"}]),B([{id:1,username:"yuki_tanaka",first_name:"雪",last_name:"田中",avatar:"",is_online:!0},{id:2,username:"masa_sato",first_name:"正",last_name:"佐藤",avatar:"",is_online:!1},{id:3,username:"ai_yamada",first_name:"愛",last_name:"山田",avatar:"",is_online:!0}]),I(12500)}catch(e){console.error("Failed to fetch data:",e),H({type:"error",text:"データの取得に失敗しました"})}finally{E(!1)}},en=async()=>{try{let e=await fetch("/api/admin/reward-settings");if(e.ok){let s=await e.json();ea(s.data)}}catch(e){console.error("Failed to fetch reward settings:",e)}},ei=()=>{let e=X;V&&(e=X.filter(e=>e.username.toLowerCase().includes(V.toLowerCase())||e.first_name.toLowerCase().includes(V.toLowerCase())||e.last_name.toLowerCase().includes(V.toLowerCase()))),R(e)},el=async()=>{if(ee&&!(J.points<=0)){if(J.points<et.min_present_amount){H({type:"error",text:`最小プレゼント金額は${et.min_present_amount}ポイントです`});return}if(J.points>et.max_present_amount){H({type:"error",text:`最大プレゼント金額は${et.max_present_amount}ポイントです`});return}if(U<J.points){H({type:"error",text:"ポイントが不足しています"});return}T(!0),H(null);try{let e=await fetch("/api/points/present",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recipient_id:ee.id,points:J.points,message:J.message})});if(e.ok){await e.json();let s=et.present_reward_enabled?Math.floor(J.points*(et.present_reward_rate/100)):0;I(e=>e-J.points+s),H({type:"success",text:`${ee.first_name}さんに${J.points}ポイントをプレゼントしました！${s>0?` (${s}ポイント還元)`:""}`}),Y(!1),K({recipient_id:null,points:0,message:""}),es(null)}else{let s=await e.json();H({type:"error",text:s.message||"プレゼントに失敗しました"})}}catch(e){H({type:"error",text:"ネットワークエラーが発生しました"})}finally{T(!1)}}},ec=()=>{let e=N;Z&&(e=e.filter(e=>e.category===Z)),S&&(e=e.filter(e=>e.name.toLowerCase().includes(S.toLowerCase())||e.description.toLowerCase().includes(S.toLowerCase())||e.provider_name.toLowerCase().includes(S.toLowerCase()))),k(e)},ed=async()=>{if(q){if(U<q.points_required){H({type:"error",text:"ポイントが不足しています"});return}T(!0),H(null);try{await new Promise(e=>setTimeout(e,2e3));let e={id:Date.now(),exchange_code:`EX${Date.now().toString().slice(-6)}`,status:"processing",digital_code:"digital"===q.gift_type?`DG${Math.random().toString(36).substring(2,8).toUpperCase()}`:void 0,points_spent:q.points_required,exchanged_at:new Date().toISOString()};P(e),I(e=>e-q.points_required),H({type:"success",text:"ギフト交換が完了しました！"}),M(null),A({recipient_email:"",recipient_name:"",delivery_address:"",notes:""}),er()}catch(e){H({type:"error",text:"ギフト交換に失敗しました"})}finally{T(!1)}}},eo=e=>{switch(e){case"digital":return(0,a.jsx)(i.Z,{className:"w-4 h-4"});case"physical":return(0,a.jsx)(l.Z,{className:"w-4 h-4"});default:return(0,a.jsx)(c.Z,{className:"w-4 h-4"})}},ex=e=>{switch(e){case"digital":return"デジタル";case"physical":return"現物";case"voucher":return"バウチャー";case"coupon":return"クーポン";default:return e}};return z?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-pink-100 via-rose-100 to-pink-50",children:(0,a.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500"})})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-pink-100 via-rose-100 to-pink-50",children:[(0,a.jsx)("div",{className:"bg-white shadow-lg",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("button",{onClick:()=>e.push("/user"),className:"p-2 hover:bg-gray-100 rounded-xl transition-all duration-200 transform hover:scale-105",title:"ダッシュボードに戻る",children:(0,a.jsx)(d.Z,{className:"w-6 h-6 text-pink-600"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-pink-500 to-rose-500 rounded-xl flex items-center justify-center shadow-md",children:(0,a.jsx)(o.Z,{className:"w-7 h-7 text-white"})}),(0,a.jsx)("span",{className:"text-2xl font-light text-pink-600",style:{fontFamily:"Dancing Script, Brush Script MT, cursive",fontStyle:"italic"},children:"biid StoreConnect"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 bg-pink-500 px-3 py-1 rounded-full shadow-sm",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4 text-white"}),(0,a.jsx)("span",{className:"text-lg font-bold text-white",children:U.toLocaleString()}),(0,a.jsx)("span",{className:"text-sm text-pink-100",children:"pt"})]})]})})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-3xl shadow-xl p-6 border border-pink-200",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-pink-600 to-rose-600 bg-clip-text text-transparent",children:"ギフト交換"}),(0,a.jsx)("p",{className:"text-gray-600",children:"貯めたポイントで素敵なギフトと交換しよう！"})]})]})})}),D&&(0,a.jsxs)("div",{className:`p-4 rounded-2xl flex items-center space-x-3 ${"success"===D.type?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:["success"===D.type?(0,a.jsx)(m.Z,{className:"w-5 h-5 text-green-600"}):(0,a.jsx)(p.Z,{className:"w-5 h-5 text-red-600"}),(0,a.jsx)("span",{className:`font-medium ${"success"===D.type?"text-green-700":"text-red-700"}`,children:D.text})]}),O&&(0,a.jsx)("div",{className:"card-cute border-l-4 border-green-400 bg-green-50",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center",children:(0,a.jsx)(m.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-green-800",children:"交換完了！"}),(0,a.jsxs)("p",{className:"text-green-700",children:["交換コード: ",O.exchange_code]}),O.digital_code&&(0,a.jsxs)("p",{className:"text-green-700 font-mono",children:["デジタルコード: ",O.digital_code]}),(0,a.jsxs)("p",{className:"text-sm text-green-600",children:[O.points_spent,"ポイントを使用しました"]})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-3xl shadow-xl p-6 border border-pink-200 mb-6",children:(0,a.jsxs)("div",{className:"flex space-x-1 bg-pink-50 rounded-2xl p-1",children:[(0,a.jsxs)("button",{onClick:()=>t("gifts"),className:`flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-xl font-medium transition-all duration-200 ${"gifts"===s?"bg-white text-pink-600 shadow-md":"text-gray-600 hover:text-pink-600"}`,children:[(0,a.jsx)(c.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"ギフト交換"})]}),(0,a.jsxs)("button",{onClick:()=>t("points"),className:`flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-xl font-medium transition-all duration-200 ${"points"===s?"bg-white text-pink-600 shadow-md":"text-gray-600 hover:text-pink-600"}`,children:[(0,a.jsx)(u.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"ポイントプレゼント"})]})]})}),"gifts"===s&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"bg-white rounded-3xl shadow-xl p-6 border border-pink-200 mb-6",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(h.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,a.jsx)("input",{type:"text",value:S,onChange:e=>$(e.target.value),className:"w-full pl-12 pr-4 py-3 border border-pink-200 rounded-2xl focus:ring-2 focus:ring-pink-500 focus:border-pink-500 bg-pink-50/30",placeholder:"ギフトを検索..."})]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(g.Z,{className:"w-5 h-5 text-gray-400"}),(0,a.jsxs)("select",{value:Z||"",onChange:e=>C(e.target.value?parseInt(e.target.value):null),className:"border border-pink-200 rounded-2xl px-4 py-3 focus:ring-2 focus:ring-pink-500 focus:border-pink-500 bg-pink-50/30 min-w-[150px]",children:[(0,a.jsx)("option",{value:"",children:"すべてのカテゴリ"}),b.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]})})}),"points"===s&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"bg-white rounded-3xl shadow-xl p-6 border border-pink-200 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-pink-500 to-rose-500 rounded-full flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"ポイントプレゼント"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"友達にポイントをプレゼントしよう"})]})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(f.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,a.jsx)("input",{type:"text",value:V,onChange:e=>W(e.target.value),className:"w-full pl-12 pr-4 py-3 border border-pink-200 rounded-2xl focus:ring-2 focus:ring-pink-500 focus:border-pink-500 bg-pink-50/30",placeholder:"友達を検索..."})]})}),(0,a.jsx)("div",{className:"space-y-3 mb-6",children:G.length>0?G.map(e=>(0,a.jsxs)("div",{className:`flex items-center justify-between p-4 border rounded-2xl cursor-pointer transition-all duration-200 ${ee?.id===e.id?"border-pink-500 bg-pink-50":"border-gray-200 hover:border-pink-300 hover:bg-pink-50/30"}`,onClick:()=>es(e),children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-pink-400 to-rose-500 rounded-full flex items-center justify-center text-white font-bold",children:e.first_name?e.first_name.charAt(0):e.username.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.first_name&&e.last_name?`${e.first_name} ${e.last_name}`:e.username}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["@",e.username]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:`w-2 h-2 rounded-full ${e.is_online?"bg-green-500":"bg-gray-300"}`}),(0,a.jsx)("span",{className:`text-xs ${e.is_online?"text-green-600":"text-gray-500"}`,children:e.is_online?"オンライン":"オフライン"}),ee?.id===e.id&&(0,a.jsx)("div",{className:"w-5 h-5 bg-pink-500 rounded-full flex items-center justify-center",children:(0,a.jsx)(y.Z,{className:"w-3 h-3 text-white"})})]})]},e.id)):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(f.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"友達が見つかりませんでした"})]})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("button",{onClick:()=>Y(!0),disabled:!ee,className:`px-6 py-3 rounded-2xl font-medium transition-all duration-200 ${ee?"bg-gradient-to-r from-pink-500 to-rose-500 text-white hover:from-pink-600 hover:to-rose-600 shadow-lg hover:shadow-xl":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"ポイントをプレゼントする"})})]})}),"gifts"===s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-3xl shadow-xl p-6 border border-pink-200 hover:shadow-2xl transition-shadow duration-200",children:[(0,a.jsx)("div",{className:"aspect-w-16 aspect-h-9 mb-4",children:(0,a.jsx)("img",{src:e.image_url,alt:e.name,className:"w-full h-48 object-cover rounded-2xl",onError:e=>{e.currentTarget.src="/api/placeholder/400/300"}})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-bold text-gray-800 line-clamp-2",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.provider_name})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-xs bg-gray-100 px-2 py-1 rounded-full",children:[eo(e.gift_type),(0,a.jsx)("span",{children:ex(e.gift_type)})]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"text-lg font-bold text-purple-600",children:[e.points_required.toLocaleString(),"pt"]}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["(\xa5",parseFloat(e.original_price).toLocaleString(),")"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-gray-500",children:[(0,a.jsx)(j.Z,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:[e.exchange_count,"回交換"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.unlimited_stock?(0,a.jsx)("span",{className:"text-green-600",children:"在庫潤沢"}):(0,a.jsxs)("span",{children:["残り ",e.stock_quantity,"個"]})}),(0,a.jsx)("button",{onClick:()=>M(e),disabled:!e.is_available||U<e.points_required,className:`btn-primary text-sm py-2 px-4 ${!e.is_available||U<e.points_required?"opacity-50 cursor-not-allowed":""}`,children:U<e.points_required?"ポイント不足":"交換する"})]})]})]},e.id))}),0===w.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(c.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"該当するギフトが見つかりませんでした"})]})]}),q&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-3xl shadow-pop max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("img",{src:q.image_url,alt:q.name,className:"w-24 h-24 object-cover rounded-2xl mx-auto mb-4",onError:e=>{e.currentTarget.src="/api/placeholder/400/300"}}),(0,a.jsx)("h3",{className:"text-2xl font-bold gradient-text",children:q.name}),(0,a.jsx)("p",{className:"text-gray-600",children:q.provider_name}),(0,a.jsxs)("p",{className:"text-lg font-bold text-purple-600 mt-2",children:[q.points_required.toLocaleString(),"pt"]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"商品説明"}),(0,a.jsx)("p",{className:"text-sm bg-gray-50 p-3 rounded-lg",children:q.description})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"利用方法"}),(0,a.jsx)("p",{className:"text-sm bg-gray-50 p-3 rounded-lg",children:q.usage_instructions})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"注意事項"}),(0,a.jsx)("p",{className:"text-sm bg-gray-50 p-3 rounded-lg",children:q.terms_conditions})]}),"digital"===q.gift_type&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"受取メールアドレス"}),(0,a.jsx)("input",{type:"email",value:L.recipient_email,onChange:e=>A(s=>({...s,recipient_email:e.target.value})),className:"input-cute",placeholder:"例: user@example.com"})]}),"physical"===q.gift_type&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"受取人名"}),(0,a.jsx)("input",{type:"text",value:L.recipient_name,onChange:e=>A(s=>({...s,recipient_name:e.target.value})),className:"input-cute",placeholder:"例: 田中太郎"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"配送先住所"}),(0,a.jsx)("textarea",{value:L.delivery_address,onChange:e=>A(s=>({...s,delivery_address:e.target.value})),className:"input-cute h-24 resize-none",placeholder:"例: 〒123-4567 東京都●●区●●町1-2-3"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"備考（任意）"}),(0,a.jsx)("textarea",{value:L.notes,onChange:e=>A(s=>({...s,notes:e.target.value})),className:"input-cute h-20 resize-none",placeholder:"特別な要望やメッセージがあればご記入ください"})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,a.jsx)("button",{onClick:()=>M(null),className:"flex-1 px-4 py-3 border-2 border-gray-300 text-gray-700 rounded-2xl font-semibold hover:bg-gray-50 transition-colors duration-200",children:"キャンセル"}),(0,a.jsx)("button",{onClick:ed,disabled:F,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:F?(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),(0,a.jsx)("span",{children:"交換中..."})]}):"交換する"})]})]})})}),Q&&ee&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-3xl shadow-pop max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-pink-500 to-rose-500 rounded-full flex items-center justify-center text-white text-2xl font-bold mx-auto mb-4",children:ee.first_name?ee.first_name.charAt(0):ee.username.charAt(0).toUpperCase()}),(0,a.jsxs)("h3",{className:"text-2xl font-bold text-gray-900",children:[ee.first_name&&ee.last_name?`${ee.first_name} ${ee.last_name}`:ee.username,"にプレゼント"]}),(0,a.jsxs)("p",{className:"text-gray-600",children:["@",ee.username]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"プレゼントポイント数"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"number",min:et.min_present_amount,max:Math.min(et.max_present_amount,U),value:J.points||"",onChange:e=>K(s=>({...s,points:parseInt(e.target.value)||0})),className:"w-full px-4 py-3 border border-pink-200 rounded-2xl focus:ring-2 focus:ring-pink-500 focus:border-pink-500",placeholder:`${et.min_present_amount} - ${Math.min(et.max_present_amount,U)}`}),(0,a.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm",children:"pt"})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,a.jsxs)("span",{children:["最小: ",et.min_present_amount,"pt"]}),(0,a.jsxs)("span",{children:["最大: ",Math.min(et.max_present_amount,U),"pt"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"メッセージ（任意）"}),(0,a.jsx)("textarea",{value:J.message,onChange:e=>K(s=>({...s,message:e.target.value})),className:"w-full px-4 py-3 border border-pink-200 rounded-2xl focus:ring-2 focus:ring-pink-500 focus:border-pink-500 h-24 resize-none",placeholder:"プレゼントと一緒に送るメッセージを入力してください"})]}),et.present_reward_enabled&&J.points>0&&(0,a.jsxs)("div",{className:"bg-pink-50 border border-pink-200 rounded-2xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-pink-600 mb-2",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"プレゼント還元"})]}),(0,a.jsxs)("p",{className:"text-sm text-pink-700",children:[Math.floor(J.points*(et.present_reward_rate/100)),"ポイント還元 (",et.present_reward_rate,"%)"]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,a.jsx)("button",{onClick:()=>{Y(!1),K({recipient_id:null,points:0,message:""}),es(null)},className:"flex-1 px-4 py-3 border-2 border-gray-300 text-gray-700 rounded-2xl font-semibold hover:bg-gray-50 transition-colors duration-200",children:"キャンセル"}),(0,a.jsx)("button",{onClick:el,disabled:F||J.points<=0,className:"flex-1 bg-gradient-to-r from-pink-500 to-rose-500 text-white px-4 py-3 rounded-2xl font-semibold hover:from-pink-600 hover:to-rose-600 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:F?(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),(0,a.jsx)("span",{children:"送信中..."})]}):`${J.points}pt プレゼント`})]})]})})})]})})]})}},1163:function(e,s,t){e.exports=t(2937)}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=334)}),_N_E=e.O()}]);